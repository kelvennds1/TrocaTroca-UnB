<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../static/styles/swap.css">
</head>
<body>
    <div wrapper>
        <header>
            <div class="back-button">
                <!-- <div class="back-button-child"></div> -->
                <img class="back-button-img" alt="" src="../static/img/back-button.svg" />
                <!-- <a href="/login" class="back-link"></a> -->
            </div>

            <div class="tag-superior">
              <div class="troca-troca">TrocaTroca</div>
              <img class="image-logo" src="/TrocaTroca-UnB/static/img/logo-trocatroca.png" alt="logo">
            </div>
        </header>

        <div class="box-bordy">
          <div class="register-text">Registrar transação</div>
          <form method="POST" action="/swap">

            <label for="swap_type">Qual o tipo de transação?</label>
            <select id="swap_type" name="swap_type">
              <option value="Troca" selected>Troca</option>
              <option value="Doação">Doação</option>
            </select>

            {% if swap_type == 'Doação' %}
              <label for="donation_party_type">Você está doando ou recebendo?</label>
              <select id="donation_party_type" name="donation_party_type">
                <option value="Doando">'Doando'</option>
                <option value="Recebendo">'Recebendo'</option>
              </select>
            {% endif %}
            
            <div class="input-container">
              <label for="iditem_receive">Seu ID:</label>
              <input class="input-caracter" type="text" id="idperson_this_party" name="idperson_this_party">         
              
              {% if donation_party_type is None or donation_party_type ==  'Doando' %}
                <label for="iditem_give">ID do item que você dará:</label>
                <input class="input-caracter" type="text" id="iditem_give" name="iditem_give">
              {% endif %}

              <label for="iditem_receive">ID de user da outra parte da troca:</label>
              <input class="input-caracter" type="text" id="idperson_other_party" name="idperson_other_party">  
              
              {% if donation_party_type is None or donation_party_type ==  'Recebendo' %}
                <label for="iditem_receive">ID do item desejado:</label>
                <input class="input-caracter" type="text" id="iditem_receive" name="iditem_receive">   
              {% endif %}

              <button type="submit" class="button-submit">Submit</button>
            </div>
          </form>
        </div>
       
      <br>
      <br>
      <br>
          <!-- {# !TODO: this is clashing w route logic in swap.py , needs clarity #} -->
        <script>
          function checkSwapStatus() {
            fetch('/swap_status')
              .then(response => response.json())
              .then(data => {
                if (data.status === 'success') {
                  window.location.href = '/swap_success';
                } else if (data.status === 'pending') {
                  pass
                } else {
                window.location.href = '/swap_fail';
                }
              });
          }
          setInterval(checkSwapStatus, 1000);
        </script>
    
        <div class="waves-container">
            <svg width="100vw" height="95" viewBox="0 0 414 95" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M0 45H17C35 45 69 45 104 50C138 54 173 62 207 60C242 58 276 45 311 39C345 33 380 33 397 33H414V95H397C380 95 345 95 311 95C276 95 242 95 207 95C173 95 138 95 104 95C69 95 35 95 17 95H0V45Z" fill="#0BAD59"/>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M0 12.585L17 16.585C35 20.585 69 29.585 104 35.585C138 41.585 173 45.585 207 37.585C242 29.585 276 8.585 311 2.585C345 -4.415 380 4.585 397 8.585L414 12.585V74.585H397C380 74.585 345 74.585 311 74.585C276 74.585 242 74.585 207 74.585C173 74.585 138 74.585 104 74.585C69 74.585 35 74.585 17 74.585H0V12.585Z" fill="#0BAD59" fill-opacity="0.75"/>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M0 21.3797L17.25 19.3122C34.5 17.2447 69 13.1097 103.5 19.3122C138 25.5148 172.5 42.0548 207 39.9873C241.5 37.9198 276 17.2447 310.5 15.1772C345 13.1097 379.5 29.6498 396.75 37.9198L414 46.1899V71H396.75C379.5 71 345 71 310.5 71C276 71 241.5 71 207 71C172.5 71 138 71 103.5 71C69 71 34.5 71 17.25 71H0V21.3797Z" fill="#0BAD59" fill-opacity="0.5"/>
            </svg>
        </div>
    </div></body>
</html>